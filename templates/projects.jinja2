{% extends 'layout.html' %}

{% block content %}
<section class="projects-intro">
    <div class="projects-intro__header">
        <h2><b>Dev FrontEnd,</b> Projetos Acadêmicos, Pessoais e de Treino.</h2>
        <p>Com estudos focados em design e desenvolvimento frontend, tenho praticado React.js, Sass, TypeScript, Next.js entre outras ferramentas comumente utilizadas na área. Essa página é dedicada para a exibição do resultado destes estudos.</p>
    </div>
</section>

<section class="projects">
    <div class="swiper swiper-projects">
        <div class="projects__cards swiper-wrapper">
            {% for project in projects %}
                <button type="button" data-bs-toggle="offcanvas" data-bs-target="#offcanvasProjects" aria-controls="offcanvasProjects" onclick="handleSelectedId('{{loop.index}}')" class="projects__card swiper-slide" id="{{loop.index}}">
                    <div class="projects__content">
                        <div class="projects__image-container">
                            <img src="{{url_for('static', filename=project.image)}}" alt="imagem">
                        </div>

                        <div class="projects__content-wrapper">
                            <div class="projects__header">
                                <div class="projects__texts">
                                    <h4>{{project.title}}</h4>
                                    <label>{{project.status}}</label>
                                </div>
                                <div class="projects__dates">
                                    <span>{{project.period_start}}</span>
                                    <span>{{project.period_end}}</span>
                                </div>
                            </div>
                            <div class="projects__info">
                                <p class="projects__cutoff-text">{{project.desc}}</p>
                                <i>Projeto {{project.type}}</i>
                            </div>
                            <div class="projects__footer">
                            {% if project.tech|length > 3 %}
                                {% for tec in project.tech[:3] %}
                                    <span class="badge projects__tec">{{tec}}</span>
                                {% endfor %}
                                    <span class="badge projects__tec projects__tec--plus"><i class='bx  bx-plus'></i> {{project.tech|length - 3}} </span>
                            {% else %}
                                {% for tec in project.tech %}
                                    <span class="badge projects__tec">{{tec}}</span>
                                {% endfor %}
                            {% endif %}
                            </div>
                        </div>
                        

                    </div>
                </button>
            {% endfor %}
            <div class="swiper-slide">
            </div>
            
        </div>
        
        <div class="d-flex mt-5 gap-3">
            <div class="swiper-button-prev"></div>
            <div class="swiper-button-next"></div>
        </div>
    </div>
</section>



{% endblock %}

{% block out_smooth_scroller %}

<div class="offcanvas offcanvas-end w-50" tabindex="-1" id="offcanvasProjects" aria-labelledby="offcanvasProjectsLabel">
  <div class="offcanvas-header offcanvas__header d-flex flex-row-reverse justify-content-between w-100 p-4">
    <h2 class="offcanvas-title flex-grow-1 text-center" id="offcanvasProjectsLabel">Detalhes do Projeto</h2>
    <button type="button" class="btn-close" data-bs-dismiss="offcanvas" aria-label="Close"></button>
  </div>
  <div class="offcanvas-body p-0">
    <figure class="offcanvas__image-container">
        <img class="offcanvas__image" src="" alt="Imagem do Projeto"  />
    </figure>
    <div class="offcanvas__content p-5 d-flex flex-column gap-4">
        <h2 class="offcanvas__title"></h2>
        <div>
            <h4 class="mb-4"> Sobre o Projeto </h4>
            <p class="offcanvas__desc"></p>
            <p class="offcanvas__full-desc"></p>
        </div>
        <div class="mb-4">
            <h4 class="mb-4"> Tecnologias utilizadas </h4>
            <div class="offcanvas__tec-container d-flex gap-3 flex-wrap"></div>   
        </div>    
        <a target="_blank" class="projects__button projects__button--repo offcanvas__link"> Abrir repositório <i class='bx  bx-arrow-out-up-right-square'></i>   </a>
    </div>
    
  </div>
</div>


{% endblock %}

{% block scripts %}

<script>
    const lista_projetos = {{projects | tojson | safe }};

    const offcanvasTitulo = document.querySelector('.offcanvas__title');
    const offcanvasCorpo = document.querySelector('.offcanvas__desc');
    const offcanvasDescricao = document.querySelector('.offcanvas__full-desc');
    const offcanvasImagem = document.querySelector('.offcanvas__image');
    const offcanvasTecnologias = document.querySelector('.offcanvas__tec-container');
    const offcanvasRepo = document.querySelector('.offcanvas__link');

    const handleSelectedId = (id) => {
        let idSelecionado = id;
        
        const projetoSelecionado = lista_projetos.find(projeto => projeto.id === parseInt(idSelecionado));
        console.log(projetoSelecionado.title);
    
        const tecnologias = projetoSelecionado.tech.map(tec => `<label>${tec}</label>`);
        console.log(tecnologias);
        
        offcanvasImagem.src = `static/${projetoSelecionado.image}`;
        offcanvasTitulo.textContent = projetoSelecionado.title;
        offcanvasCorpo.textContent = projetoSelecionado.desc;
        offcanvasTecnologias.innerHTML = projetoSelecionado.tech.map(tec => `<label class="badge offcanvas__badge">${tec}</label>`).join('');
        offcanvasRepo.href = projetoSelecionado.repository;
        offcanvasDescricao.textContent = projetoSelecionado.full_desc;

  
    }
        
    gsap.registerPlugin(ScrollTrigger);

ScrollTrigger.matchMedia({
    "(min-width: 500px)": function() {
        
        gsap.from('.projects-intro__header h2', { duration: 1, y: -20 });
        
        gsap.from('.projects-intro__header p', { duration: 1, y: -20 });
        
        gsap.to('.projects-intro__header h2', { 
            duration: 1, 
            x: -100, 
            opacity: 0, 
            scrollTrigger: { 
                trigger: 'projects-intro', 
                scrub: true 
            } 
        });
        
        gsap.to('.projects-intro__header p', { 
            duration: 1, 
            x: 100, 
            opacity: 0, 
            scrollTrigger: { 
                trigger: 'projects-intro', 
                scrub: true 
            } 
        });

    }
});
    




</script>

{% endblock %}